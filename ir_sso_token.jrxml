<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ir_dp_open_account" language="groovy" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="0" bottomMargin="20" uuid="4bf95852-3b18-4cd2-ae5d-f2237cafbe9c">
	<property name="ireport.zoom" value="1.2100000000000006"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="net.sf.jasperreports.export.xls.detect.cell.type" value="true"/>
	<parameter name="adtm_start" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="adtm_end" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_scoop" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_ecoop" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_reportid" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_entryid" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT
a3.USER_NAME AS USER_NAME,
a3.FULL_NAME AS FULL_NAME,
a.DESCRIPTION AS APPLICATION,
a2.PAGE_DESCRIPTION AS PAGE_NAME,
s.CLIENT_IP ,
s.CREATE_TIME ,
CASE
	WHEN s.APPLICATION IS NULL THEN 'เข้าสู่ระบบ'
	WHEN s.SAVE_STATUS = 1 THEN 'บันทึกข้อมูล'
	ELSE 'เข้าใช้งาน'
END AS EVENT_NAME
FROM SSOTOKEN s
LEFT JOIN AMAPPSTATUS a ON s.APPLICATION = a.APPLICATION
LEFT JOIN AMWEBPAGE a2 ON s.WIN_OBJECT = a2.PAGE_ID
LEFT JOIN AMWEBUSERS a3 ON s.USERNAME = a3.USER_NAME
WHERE (TRUNC(s.CREATE_TIME) between $P{adtm_start} and $P{adtm_end})
AND (s.COOP_ID = $P{as_scoop})
order by 	a3.USER_NAME, s.CREATE_TIME, a.DESCRIPTION]]>
	</queryString>
	<field name="USER_NAME" class="java.lang.String"/>
	<field name="FULL_NAME" class="java.lang.String"/>
	<field name="APPLICATION" class="java.lang.String"/>
	<field name="PAGE_NAME" class="java.lang.String"/>
	<field name="CLIENT_IP" class="java.lang.String"/>
	<field name="CREATE_TIME" class="java.sql.Timestamp"/>
	<field name="EVENT_NAME" class="java.lang.String"/>
	<group name="deptmain_type" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{USER_NAME}]]></groupExpression>
		<groupHeader>
			<band height="54">
				<textField>
					<reportElement uuid="21a17960-288d-4cdf-9451-1ffff34b9de8" x="0" y="5" width="802" height="20"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Angsana New" size="16" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA["ผู้ใช้งาน : "+$F{USER_NAME}+" - "+ $F{FULL_NAME}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="110e059e-25aa-4522-a14d-fb6d8b1c7534" x="1" y="34" width="140" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="16" isBold="true"/>
					</textElement>
					<text><![CDATA[ระบบ]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="45c9cd7b-359f-47f8-9a38-6a25191cd347" x="141" y="34" width="296" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="16" isBold="true"/>
					</textElement>
					<text><![CDATA[ชื่อหน้าจอ]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="c28aa292-fe15-4c53-89cc-79b6accc54ea" x="437" y="34" width="175" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="16" isBold="true"/>
					</textElement>
					<text><![CDATA[วันที่ทำรายการ]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="4d63e960-9bce-4cb0-b19c-a0497cf6a10f" x="707" y="34" width="95" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="16" isBold="true"/>
					</textElement>
					<text><![CDATA[กิจกรรม ]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="c493f146-5a31-4149-9444-f782e58c88b0" x="612" y="34" width="95" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Right" verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="16" isBold="true"/>
					</textElement>
					<text><![CDATA[หมายเลข IP]]></text>
				</staticText>
			</band>
		</groupHeader>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="20" splitType="Stretch">
			<subreport isUsingCache="false">
				<reportElement uuid="2857cca6-78cb-4c9c-8a57-6c2d7f03c031" x="1" y="0" width="801" height="20"/>
				<subreportParameter name="as_coopid">
					<subreportParameterExpression><![CDATA[$P{as_scoop}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="as_reportid">
					<subreportParameterExpression><![CDATA[$P{as_reportid}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="as_entryid">
					<subreportParameterExpression><![CDATA[$P{as_entryid}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="as_reportdetail">
					<subreportParameterExpression><![CDATA["ช่วง วันที่  "+ new SimpleDateFormat(" dd/MM/yyyy", new Locale("th", "TH")).format($P{adtm_start})+"  ถึงวันที่  "+ new SimpleDateFormat(" dd/MM/yyyy", new Locale("th", "TH")).format($P{adtm_end})]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA["report_header\\ir_header_landscape.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</pageHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement uuid="0412d216-6d15-4b5f-9238-144157215a9d" x="1" y="0" width="140" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="16" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{APPLICATION}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="ba3493e5-d442-4dcc-9f2f-161783d455e1" x="141" y="0" width="296" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Angsana New" size="16" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{PAGE_NAME}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement uuid="e8f04901-3f4c-4dfc-a671-85ce89322ee0" x="437" y="0" width="175" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="16" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[new SimpleDateFormat("dd/MM/yyyy hh:mm:ss", new Locale("th", "TH")).format($F{CREATE_TIME})]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement uuid="d978f578-7a87-4078-8781-ed9cad6c4477" x="612" y="0" width="95" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="16" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{CLIENT_IP}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement uuid="97aedafc-1f08-487f-8dec-ef27e0cea018" x="707" y="0" width="95" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="16" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{EVENT_NAME}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="20">
			<textField evaluationTime="Report">
				<reportElement uuid="75df5e3a-f697-45bc-bea6-dcfe6be4aeb3" x="782" y="0" width="20" height="20"/>
				<textElement>
					<font fontName="Angsana New" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA["/" +$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="2c2056df-e995-4511-984d-156a8301f601" x="1" y="0" width="782" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Angsana New" size="12"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
