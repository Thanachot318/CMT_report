<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ir_deposit_with_dept_byreq_a4" language="groovy" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="792" leftMargin="30" rightMargin="20" topMargin="20" bottomMargin="20" uuid="077225f2-d81d-4896-b611-0946c29ffd12">
	<property name="ireport.zoom" value="1.331000000000003"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="work_date" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_start_type" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_end_type" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_smemcat" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_ememcat" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_entryid" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_reportid" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_coopid" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["C:\\ScoSPA_ALL\\iReport\\report_header\\"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select   dpdeptslip.*,dpdeptslipdet.*,deptmain_type,deptmain_desc,dpdeptmaster.deptaccount_name,mastran.deptaccount_name as deptaccount_name_tran
,'วิธีการรับดอกเบี้ย : '|| case when dpdeptslipdet.intpay_status = 1 then 'ทบต้น'
      when dpdeptslipdet.intpay_status = 2 then 'โอนเข้าบัญชีสหกรณ์'
      when dpdeptslipdet.intpay_status = 3 then 'โอนเข้าบัญชีธนาคาร' else '' end as intpay_desc
from dpdeptslip
join dpdeptslipdet on dpdeptslip.coop_id = dpdeptslipdet.coop_id and  dpdeptslip.deptslip_no = dpdeptslipdet.deptslip_no
join dpucfdeptmaintype on dpucfdeptmaintype.coop_id = dpdeptslip.deptcoop_id and dpucfdeptmaintype.deptmain_type = dpdeptslip.depttype_code
join dpdeptmaster on dpdeptmaster.coop_id = dpdeptslip.deptcoop_id and dpdeptmaster.deptaccount_no = dpdeptslip.deptaccount_no
left join dpdeptmaster mastran on mastran.coop_id = dpdeptslip.deptcoop_id and mastran.deptaccount_no = dpdeptslipdet.account_no
where  dpdeptslip.deptcoop_id = $P{as_coopid}
and item_status = 1
and dpdeptslip.deptitem_group ='INT' and dpdeptslipdet.recppaytype_code='INP'
and dpdeptslip.operate_date = $P{work_date}
and dpdeptslip.membcat_code between $P{as_smemcat} and $P{as_ememcat}
and dpdeptslip.depttype_code between $P{as_start_type} and $P{as_end_type}
order by dpdeptslipdet.intpay_status,dpdeptslip.depttype_code , dpdeptslip.deptaccount_no]]>
	</queryString>
	<field name="COOP_ID" class="java.lang.String"/>
	<field name="DEPTSLIP_NO" class="java.lang.String"/>
	<field name="DEPTACCOUNT_NO" class="java.lang.String"/>
	<field name="DEPTTYPE_CODE" class="java.lang.String"/>
	<field name="DEPTGROUP_CODE" class="java.lang.String"/>
	<field name="MEMBCAT_CODE" class="java.lang.String"/>
	<field name="MEMBER_NO" class="java.lang.String"/>
	<field name="ENTRY_DATE" class="java.sql.Timestamp"/>
	<field name="OPERATE_DATE" class="java.sql.Timestamp"/>
	<field name="DEPTITEM_GROUP" class="java.lang.String"/>
	<field name="ITEM_AMT" class="java.math.BigDecimal"/>
	<field name="PRNCBAL" class="java.math.BigDecimal"/>
	<field name="WITHDRAWABLE_AMT" class="java.math.BigDecimal"/>
	<field name="ENTRY_ID" class="java.lang.String"/>
	<field name="FEEWITD_STATUS" class="java.math.BigDecimal"/>
	<field name="FEEWITD_AMT" class="java.math.BigDecimal"/>
	<field name="FEECBT_STATUS" class="java.math.BigDecimal"/>
	<field name="FEECBT_AMT" class="java.math.BigDecimal"/>
	<field name="FEECHQ_STATUS" class="java.math.BigDecimal"/>
	<field name="FEECHQ_AMT" class="java.math.BigDecimal"/>
	<field name="INT_AMT" class="java.math.BigDecimal"/>
	<field name="TAX_AMT" class="java.math.BigDecimal"/>
	<field name="INT_RETURN" class="java.math.BigDecimal"/>
	<field name="TAX_RETURN" class="java.math.BigDecimal"/>
	<field name="ITEMNET_AMT" class="java.math.BigDecimal"/>
	<field name="DUE_FLAG" class="java.math.BigDecimal"/>
	<field name="ITEM_STATUS" class="java.math.BigDecimal"/>
	<field name="PRNC_NO" class="java.math.BigDecimal"/>
	<field name="MACHINE_ID" class="java.lang.String"/>
	<field name="NOBOOK_FLAG" class="java.math.BigDecimal"/>
	<field name="REMARK" class="java.lang.String"/>
	<field name="CANCEL_ID" class="java.lang.String"/>
	<field name="CANCEL_DATE" class="java.sql.Timestamp"/>
	<field name="CANCEL_TIME" class="java.sql.Timestamp"/>
	<field name="CANCEL_CODE" class="java.lang.String"/>
	<field name="AUTHORIZE_ID" class="java.lang.String"/>
	<field name="SAVE_TIME" class="java.sql.Timestamp"/>
	<field name="REF_SLIPNO" class="java.lang.String"/>
	<field name="POST_TOFIN" class="java.math.BigDecimal"/>
	<field name="SIGN_FLAG" class="java.math.BigDecimal"/>
	<field name="DEPTCOOP_ID" class="java.lang.String"/>
	<field name="POST_CLOSEDAY" class="java.math.BigDecimal"/>
	<field name="SEQ_NO" class="java.math.BigDecimal"/>
	<field name="TOFROM_ACCID" class="java.lang.String"/>
	<field name="RECPPAYTYPE_CODE" class="java.lang.String"/>
	<field name="ACCOUNT_ID" class="java.lang.String"/>
	<field name="CASH_TYPE" class="java.lang.String"/>
	<field name="FEE_AMT" class="java.math.BigDecimal"/>
	<field name="BANK_CODE" class="java.lang.String"/>
	<field name="BANK_BRANCH" class="java.lang.String"/>
	<field name="CHEQUE_NO" class="java.lang.String"/>
	<field name="CHEQUE_DATE" class="java.sql.Timestamp"/>
	<field name="ACCOUNT_NO" class="java.lang.String"/>
	<field name="ACCOUNT_NAME" class="java.lang.String"/>
	<field name="REF_STMNO" class="java.math.BigDecimal"/>
	<field name="CHEQUE_TYPE" class="java.lang.String"/>
	<field name="INTPAY_STATUS" class="java.math.BigDecimal"/>
	<field name="CLEARING_DATE" class="java.sql.Timestamp"/>
	<field name="CHEQUE_STATUS" class="java.math.BigDecimal"/>
	<field name="ITEMTRAN_AMT" class="java.math.BigDecimal"/>
	<field name="DEPTMAIN_TYPE" class="java.lang.String"/>
	<field name="DEPTMAIN_DESC" class="java.lang.String"/>
	<field name="DEPTACCOUNT_NAME" class="java.lang.String"/>
	<field name="DEPTACCOUNT_NAME_TRAN" class="java.lang.String"/>
	<field name="INTPAY_DESC" class="java.lang.String"/>
	<variable name="Gall_item" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{ITEMNET_AMT}]]></variableExpression>
	</variable>
	<variable name="Gdepttype_item" class="java.math.BigDecimal" resetType="Group" resetGroup="DEPTTYPE_CODE" calculation="Sum">
		<variableExpression><![CDATA[$F{ITEMNET_AMT}]]></variableExpression>
	</variable>
	<variable name="Gdepttype_distinctcount" class="java.math.BigDecimal" resetType="Group" resetGroup="DEPTTYPE_CODE" calculation="DistinctCount">
		<variableExpression><![CDATA[$F{DEPTSLIP_NO}]]></variableExpression>
	</variable>
	<group name="coop_id">
		<groupExpression><![CDATA[$F{COOP_ID}]]></groupExpression>
	</group>
	<group name="operateDate">
		<groupExpression><![CDATA[$F{OPERATE_DATE}]]></groupExpression>
	</group>
	<group name="intPayStatus" isStartNewPage="true" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{INTPAY_STATUS}]]></groupExpression>
		<groupHeader>
			<band height="20">
				<textField>
					<reportElement uuid="3778eede-4d27-426d-afc8-db973311b80e" x="1" y="0" width="791" height="20"/>
					<textElement verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="14" isBold="true"/>
						<paragraph leftIndent="5"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{INTPAY_DESC}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
	</group>
	<group name="DEPTTYPE_CODE" isReprintHeaderOnEachPage="true">
		<groupExpression><![CDATA[$F{DEPTMAIN_TYPE}]]></groupExpression>
		<groupHeader>
			<band height="41">
				<staticText>
					<reportElement uuid="5f47b5ef-4983-4ab9-8c74-7e6bf894a874" x="1" y="1" width="80" height="20"/>
					<textElement verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="14" isBold="true"/>
					</textElement>
					<text><![CDATA[]]></text>
				</staticText>
				<textField>
					<reportElement uuid="4cdde0de-cb25-4539-b8c4-602869482466" x="0" y="1" width="792" height="20"/>
					<textElement verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="14" isBold="true"/>
						<paragraph leftIndent="5"/>
					</textElement>
					<textFieldExpression><![CDATA["ประเภทบัญชี : "+$F{DEPTMAIN_TYPE}+" - "+$F{DEPTMAIN_DESC}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="9fcf0247-1fcf-4377-8b75-3d1f167b0e36" x="568" y="21" width="223" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="14" isBold="true"/>
					</textElement>
					<text><![CDATA[ชื่อบัญชี]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="a4be6123-a191-4640-9a10-f7bf22ef386d" x="32" y="21" width="81" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="14" isBold="true"/>
					</textElement>
					<text><![CDATA[เลขที่บัญชี]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="c203a6c5-e72e-4fa5-aed1-d99f4ce3e888" x="166" y="21" width="241" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="14" isBold="true"/>
					</textElement>
					<text><![CDATA[ชื่อบัญชี]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="7ad35d0a-5325-44aa-a612-4ccdd1aad18a" x="112" y="21" width="55" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="14" isBold="true"/>
					</textElement>
					<text><![CDATA[เลขสมาชิก]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="b9202f75-2255-4c39-82a2-4b59272fda40" x="0" y="21" width="33" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="14" isBold="true"/>
					</textElement>
					<text><![CDATA[ลำดับ]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="1eb7e959-2422-497b-8231-250bb5796f9d" x="488" y="21" width="80" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="14" isBold="true"/>
					</textElement>
					<text><![CDATA[โอนเข้าบัญชีเลขที่]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="ab32d403-a3a8-4ff6-982e-2fea00056d25" x="407" y="21" width="81" height="20"/>
					<box>
						<topPen lineWidth="0.5"/>
						<bottomPen lineWidth="0.5"/>
					</box>
					<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="14" isBold="true"/>
					</textElement>
					<text><![CDATA[ดอกเบี้ย]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="35">
				<staticText>
					<reportElement uuid="2dab027e-7988-4b4d-b0f2-187a7d9a8165" x="31" y="7" width="134" height="20"/>
					<textElement verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="14" isBold="true"/>
					</textElement>
					<text><![CDATA[รวมตามประเภทบัญชี]]></text>
				</staticText>
				<textField pattern="#,##0.00">
					<reportElement uuid="64c91bd7-966c-4910-b62e-3875f55fea0c" x="407" y="7" width="80" height="20"/>
					<textElement textAlignment="Right" verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="14" isBold="true"/>
					</textElement>
					<textFieldExpression><![CDATA[$V{Gdepttype_item}]]></textFieldExpression>
				</textField>
				<line>
					<reportElement uuid="ece4b750-f4a3-431d-a78a-599b80edc6e5" x="0" y="32" width="791" height="1"/>
					<graphicElement>
						<pen lineWidth="0.5"/>
					</graphicElement>
				</line>
				<line>
					<reportElement uuid="6c92bcd6-ee41-45fb-8377-13cd703562f8" x="0" y="1" width="791" height="1"/>
					<graphicElement>
						<pen lineWidth="0.5"/>
					</graphicElement>
				</line>
			</band>
		</groupFooter>
	</group>
	<group name="deptslip_no">
		<groupExpression><![CDATA[$F{DEPTSLIP_NO}]]></groupExpression>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="20" splitType="Stretch">
			<subreport>
				<reportElement uuid="a84e4e26-5ac1-4fd5-8cf8-5f468e54bad6" x="1" y="0" width="790" height="20" isPrintWhenDetailOverflows="true"/>
				<subreportParameter name="as_entryid">
					<subreportParameterExpression><![CDATA[$P{as_entryid}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="as_coopid">
					<subreportParameterExpression><![CDATA[$P{as_coopid}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="as_reportid">
					<subreportParameterExpression><![CDATA[$P{as_reportid}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="as_reportdetail">
					<subreportParameterExpression><![CDATA[new SimpleDateFormat("dd/MM/yyyy",new Locale("th","TH")).format($F{OPERATE_DATE})]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA["C:\\ScoSPA_ALL\\iReport\\report_header\\ir_header_landscape.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</pageHeader>
	<detail>
		<band height="20">
			<textField>
				<reportElement uuid="c891d632-9bc0-4226-baaa-e9c6f9c471dc" isPrintRepeatedValues="false" x="112" y="0" width="55" height="20" isPrintInFirstWholeBand="true">
					<printWhenExpression><![CDATA[$V{deptslip_no_COUNT}==1]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Top" markup="none">
					<font fontName="Angsana New" size="14" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{MEMBER_NO}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="e42acdc2-88eb-4a72-a489-cd4bbc66bd65" x="488" y="0" width="80" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="14" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ACCOUNT_NO}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="6b5732d3-e141-4f28-bf1c-61898fad65f7" isPrintRepeatedValues="false" x="32" y="0" width="81" height="20" printWhenGroupChanges="deptslip_no">
					<printWhenExpression><![CDATA[$V{deptslip_no_COUNT}==1]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Top" markup="none">
					<font fontName="Angsana New" size="14" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DEPTACCOUNT_NO}]]></textFieldExpression>
			</textField>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement uuid="bf15c892-e1db-4ac0-ad68-31c7f457dcdd" x="568" y="0" width="223" height="20"/>
				<textElement verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="14" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DEPTACCOUNT_NAME_TRAN}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="d34a1bcc-da5c-4861-ae97-a67572206b37" x="0" y="0" width="33" height="20">
					<printWhenExpression><![CDATA[$V{deptslip_no_COUNT}==1]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="14" isBold="false"/>
					<paragraph rightIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{Gdepttype_distinctcount}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement uuid="86234c8e-4c0b-4465-baf6-bf4535fe044e" isPrintRepeatedValues="false" x="166" y="0" width="241" height="20" isPrintInFirstWholeBand="true">
					<printWhenExpression><![CDATA[$V{deptslip_no_COUNT}==1]]></printWhenExpression>
				</reportElement>
				<textElement verticalAlignment="Top" markup="none">
					<font fontName="Angsana New" size="14" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{DEPTACCOUNT_NAME}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00">
				<reportElement uuid="9bb6cb9f-1378-4c51-832a-ee4b7f99c6ec" isPrintRepeatedValues="false" x="407" y="0" width="81" height="20" isPrintInFirstWholeBand="true">
					<printWhenExpression><![CDATA[$V{deptslip_no_COUNT}==1]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right" verticalAlignment="Top" markup="none">
					<font fontName="Angsana New" size="14" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ITEMNET_AMT}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="20">
			<textField>
				<reportElement uuid="a33cd561-4861-4d43-9ded-096da5b27d82" x="696" y="0" width="80" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{PAGE_NUMBER}+" / "]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement uuid="9585f887-84cb-4850-a450-2dbf9c8b7081" x="776" y="0" width="15" height="20"/>
				<textElement>
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="22" splitType="Stretch">
			<line>
				<reportElement uuid="d80bdeb3-d3ca-4f9f-a7d2-adf720181e01" x="1" y="21" width="791" height="1"/>
				<graphicElement>
					<pen lineWidth="0.5"/>
				</graphicElement>
			</line>
			<textField pattern="#,##0.00">
				<reportElement uuid="55f6a9b1-7b47-428c-b7f3-f70da198ee3d" x="408" y="0" width="80" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{Gall_item}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="0d09e484-d1bb-4f09-b660-7ac23cedf6e1" x="31" y="0" width="134" height="20"/>
				<textElement verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[รวมทั้งหมด]]></text>
			</staticText>
		</band>
	</summary>
</jasperReport>
