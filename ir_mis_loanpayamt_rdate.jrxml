<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ir_mis_loanpayamt_rdate" language="groovy" pageWidth="595" pageHeight="842" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="b0879da4-420b-42f3-870f-306e6f861802">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="adtm_start" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="adtm_end" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_scoop" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT lt.loantype_code
, lt.loantype_desc
, mg.membcat_code
, mg.membcat_desc
, sum(ln.loanrequest_amt) as loanrequest_amt
, sum(ln.loanapprove_amt) as loanapprove_amt
, sum(nvl(so.payoutclr_amt, 0)) as payoutclr_amt
, sum(nvl(so.payoutnet_amt, 0)) as payoutnet_amt
, SUM(nvl(sid.lon_payamt, 0)) AS lonclr_amt
, SUM(nvl(sid.etc_payamt, 0)) AS etcclr_amt
, cm.coop_name
, cm.coop_id
, sysdate
from lncontmaster ln
left join slslippayout so on ln.loancontract_no = so.loancontract_no
	AND so.slip_status IN (1,8)
	AND so.sliptype_code = 'LWD'
LEFT JOIN SLSLIPPAYIN si ON so.SLIPCLEAR_NO = si.PAYINSLIP_NO
LEFT JOIN (
	SELECT payinslip_no
		, sum(CASE WHEN slipitemtype_code = 'LON' THEN item_payamt ELSE 0 END) AS lon_payamt
		, sum(CASE WHEN slipitemtype_code = 'LON' THEN 0 ELSE item_payamt END) AS etc_payamt
	FROM SLSLIPPAYINDET
	GROUP BY payinslip_no
) sid ON si.PAYINSLIP_NO = sid.PAYINSLIP_NO
join cmcoopconstant cm on ln.coop_id = cm.coop_id
join lnloantype lt on ln.loantype_code = lt.loantype_code
join mbmembmaster mb on ln.member_no = mb.member_no
join mbucfcategory mg on mb.membcat_code = mg.membcat_code
where LN.loanapprove_date BETWEEN $P{adtm_start} AND $P{adtm_end}
group by cm.coop_name
, cm.coop_id
, lt.loantype_code
, lt.loantype_desc
, mg.membcat_code
, mg.membcat_desc
order BY mg.membcat_code, lt.loantype_code]]>
	</queryString>
	<field name="LOANTYPE_CODE" class="java.lang.String"/>
	<field name="LOANTYPE_DESC" class="java.lang.String"/>
	<field name="MEMBCAT_CODE" class="java.lang.String"/>
	<field name="MEMBCAT_DESC" class="java.lang.String"/>
	<field name="LOANREQUEST_AMT" class="java.math.BigDecimal"/>
	<field name="LOANAPPROVE_AMT" class="java.math.BigDecimal"/>
	<field name="PAYOUTCLR_AMT" class="java.math.BigDecimal"/>
	<field name="PAYOUTNET_AMT" class="java.math.BigDecimal"/>
	<field name="LONCLR_AMT" class="java.math.BigDecimal"/>
	<field name="ETCCLR_AMT" class="java.math.BigDecimal"/>
	<field name="COOP_NAME" class="java.lang.String"/>
	<field name="COOP_ID" class="java.lang.String"/>
	<field name="SYSDATE" class="java.sql.Timestamp"/>
	<variable name="LOANREQUEST_AMT" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{LOANREQUEST_AMT}]]></variableExpression>
	</variable>
	<variable name="LOANAPPROVE_AMT" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{LOANAPPROVE_AMT}]]></variableExpression>
	</variable>
	<variable name="LONCLR_AMT" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{LONCLR_AMT}]]></variableExpression>
	</variable>
	<variable name="ETCCLR_AMT" class="java.math.BigDecimal" calculation="Sum">
		<variableExpression><![CDATA[$F{ETCCLR_AMT}]]></variableExpression>
	</variable>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="71" splitType="Stretch">
			<textField>
				<reportElement uuid="97f35580-c14b-4086-bea4-ea80e6f41c3b" x="0" y="0" width="555" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{COOP_NAME}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement uuid="d974cead-fcff-4c8e-b13f-44eb6b4e6ce2" x="0" y="51" width="180" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[ประเภทสินเชื่อ]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="d12aead5-97a4-42ef-8776-98bc7d18a428" x="180" y="51" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[ยอดขอกู้]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="ff439ace-973c-4e96-8aa7-0d4ed6e909fd" x="255" y="51" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[ยอดอนุมัติ]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="67116695-6960-4fa1-82f0-4f4d7818d39d" x="330" y="51" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[หักกลบหนี้]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="70467429-ef3a-4605-b0fb-b7f8e83d92b2" x="405" y="51" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[หักอื่นๆ]]></text>
			</staticText>
			<staticText>
				<reportElement uuid="4fed538b-3bf4-4ae2-aadb-1848b0f7b085" x="480" y="51" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<text><![CDATA[ยอดจ่ายจริง]]></text>
			</staticText>
			<textField>
				<reportElement uuid="ce836e58-80e8-444f-8e0f-17c7d2ba24b0" x="0" y="20" width="555" height="20"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
				</textElement>
				<textFieldExpression><![CDATA[msg("ณ วันที่ {0} ถึง {1}",
    new SimpleDateFormat("d/MM/yyyy",new Locale("th","TH")).format($P{adtm_start}),
    new SimpleDateFormat("d/MM/yyyy",new Locale("th","TH")).format($P{adtm_end}))]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField>
				<reportElement uuid="f3b98859-504b-427e-a2a4-289e10b3d0ed" x="0" y="0" width="180" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph leftIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{LOANTYPE_CODE} + " - " + $F{LOANTYPE_DESC}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00">
				<reportElement uuid="d777d8cc-13cf-418a-8b3e-1a110c2148c1" x="180" y="0" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph rightIndent="2"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{LOANREQUEST_AMT}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00">
				<reportElement uuid="cac05d5e-2b2e-4f13-b3b8-2008440d05fb" x="255" y="0" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph rightIndent="2"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{LOANAPPROVE_AMT}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement uuid="db3908f8-5e0a-449f-bcd5-feb566530774" x="330" y="0" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph rightIndent="2"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{LONCLR_AMT}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement uuid="2bcfb62c-6591-4059-bd3a-b0c89a118d4a" x="405" y="0" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph rightIndent="2"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{ETCCLR_AMT}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement uuid="2c566d74-4944-4079-b3c8-da1bcf0dae17" x="480" y="0" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.0"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph rightIndent="2"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{LOANAPPROVE_AMT}-$F{LONCLR_AMT}-$F{ETCCLR_AMT}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="20" splitType="Stretch">
			<textField>
				<reportElement uuid="a25f6422-bc44-4412-b49a-3d5636eaa59f" x="0" y="0" width="180" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph leftIndent="5"/>
				</textElement>
				<textFieldExpression><![CDATA["รวม"]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00">
				<reportElement uuid="53b98c3d-2f43-41c9-8701-da31961bb6d6" x="180" y="0" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph rightIndent="2"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{LOANREQUEST_AMT}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement uuid="e9379738-2035-4ddf-8368-70ffa6935a30" x="405" y="0" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph rightIndent="2"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{ETCCLR_AMT}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement uuid="64df1f40-62d8-4cb0-bc2c-78b9ef553e97" x="480" y="0" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph rightIndent="2"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{LOANAPPROVE_AMT}-$V{LONCLR_AMT}-$V{ETCCLR_AMT}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00" isBlankWhenNull="true">
				<reportElement uuid="de345178-ed47-457f-8ce4-1a52e9743bb1" x="330" y="0" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph rightIndent="2"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{LONCLR_AMT}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00">
				<reportElement uuid="497664f1-f525-43f2-ad90-17e6485a5fcc" x="255" y="0" width="75" height="20"/>
				<box>
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="14"/>
					<paragraph rightIndent="2"/>
				</textElement>
				<textFieldExpression><![CDATA[$V{LOANAPPROVE_AMT}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
