<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ir_mbshr_confirm" language="groovy" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="b994b816-7d69-4f11-ba5a-81ce679eae67">
	<property name="ireport.zoom" value="1.7715610000000013"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="419"/>
	<parameter name="as_coopid" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_smemno" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_ememno" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA["C:\\GCOOP_ALL\\MJU\\GCOOP\\iReport\\Reports\\"]]></defaultValueExpression>
	</parameter>
	<parameter name="as_ememgroup" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_smemgroup" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_manager" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_auditor" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="adtm_date" class="java.util.Date">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="as_reportid" class="java.lang.String"/>
	<parameter name="as_entryid" class="java.lang.String"/>
	<queryString>
		<![CDATA[select
RANK() OVER (PARTITION BY yrm.membgroup_code ORDER BY yrm.member_no) as RANK ,
yrm.member_no,
mfp.prename_desc,
mbm.memb_name,
mbm.memb_surname,
rtrim(mbm.membgroup_code) as membgroup_code,
mbg.membgroup_desc,
yrm.balance_date,
(select sum(balance_amt) from yrconfirmstatement ys where from_system ='LON' and yrm.member_no = ys.member_no and yrm.balance_date = ys.balance_date) as loan_balance ,
(select sum(balance_amt) from yrconfirmstatement ys where from_system ='SHR' and yrm.member_no = ys.member_no and yrm.balance_date = ys.balance_date) as share_balance

from yrconfirmmaster yrm
left join mbmembmaster mbm on yrm.member_no = mbm.member_no
left join mbucfprename mfp on mbm.prename_code = mfp.prename_code
left join mbucfmembgroup mbg on mbm.membgroup_code = mbg.membgroup_code
where yrm.coop_id = $P{as_coopid}
and yrm.membgroup_code between $P{as_smemgroup} and $P{as_ememgroup}
and yrm.member_no between $P{as_smemno} and $P{as_ememno}
and yrm.balance_date = $P{adtm_date}
and yrm.member_no in (select member_no from yrconfirmstatement yss where from_system ='SHR' and yrm.member_no = yss.member_no and yrm.balance_date = yss.balance_date  )
group by yrm.member_no,
yrm.membgroup_code,
yrm.member_no,
mfp.prename_desc,
mbm.memb_name,
mbm.memb_surname,
mbm.membgroup_code,
mbg.membgroup_desc,
yrm.balance_date
ORDER BY mbm.membgroup_code , yrm.member_no]]>
	</queryString>
	<field name="RANK" class="java.math.BigDecimal"/>
	<field name="MEMBER_NO" class="java.lang.String"/>
	<field name="PRENAME_DESC" class="java.lang.String"/>
	<field name="MEMB_NAME" class="java.lang.String"/>
	<field name="MEMB_SURNAME" class="java.lang.String"/>
	<field name="MEMBGROUP_CODE" class="java.lang.String"/>
	<field name="MEMBGROUP_DESC" class="java.lang.String"/>
	<field name="BALANCE_DATE" class="java.sql.Timestamp"/>
	<field name="LOAN_BALANCE" class="java.math.BigDecimal"/>
	<field name="SHARE_BALANCE" class="java.math.BigDecimal"/>
	<group name="member_no" isStartNewPage="true">
		<groupExpression><![CDATA[$F{MEMBER_NO}]]></groupExpression>
		<groupHeader>
			<band height="137">
				<staticText>
					<reportElement uuid="4e206217-d3d0-4337-bb39-a467383517f1" x="0" y="0" width="555" height="20"/>
					<textElement textAlignment="Center">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<text><![CDATA[หนังสือยืนยันยอดเงินรับฝาก]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="cbb363c2-55ee-4786-954e-472084c62710" x="267" y="20" width="129" height="20"/>
					<textElement verticalAlignment="Bottom">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<text><![CDATA[วันที่ ...................................]]></text>
				</staticText>
				<textField>
					<reportElement uuid="9eb66570-6eca-4332-8198-ce0d434270fd" x="291" y="20" width="72" height="20"/>
					<textElement textAlignment="Center">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA[new SimpleDateFormat("dd/MM/yyyy",new Locale("th","TH")).format($P{adtm_date})]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="88cd6fb5-023c-45a0-8a0a-fa3d81c5e73f" x="0" y="40" width="186" height="20"/>
					<textElement>
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA["เรียน      "+$F{PRENAME_DESC}+$F{MEMB_NAME}+"   "+$F{MEMB_SURNAME}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="c1479db5-520d-4237-a2cd-e4f5c3a2c254" x="186" y="40" width="105" height="20"/>
					<textElement>
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA["เลขทะเบียนที่ "+$F{MEMBER_NO}]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="7d5c80d5-db23-44f4-b143-87d5a963a3b1" x="291" y="40" width="264" height="20"/>
					<textElement>
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA["หน่วย "+$F{MEMBGROUP_DESC}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="ce46e6e2-efa0-43e8-8905-32ad1d07b2d6" x="69" y="60" width="243" height="20"/>
					<textElement>
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<text><![CDATA[สหกรณ์ออมทรัพย์มหาวิทยาลัยแม่โจ้ จำกัด]]></text>
				</staticText>
				<textField>
					<reportElement uuid="ef1fcd53-82b7-4581-a5b6-0c1b2275267e" x="44" y="80" width="511" height="20"/>
					<textElement>
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA["ขอเรียนว่าท่านได้ทำธุรกิจกับสหกรณ์ และมียอดคงเหลือต่างๆ ณ วันที่ "+new SimpleDateFormat("dd/MM/yyyy",new Locale("th","TH")).format($P{adtm_date})+"    ดังนี้"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="dd6cbd65-3917-45a8-a8e3-3524ad8b17d0" x="424" y="0" width="131" height="20"/>
					<textElement>
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA["เลขที่ "+$F{MEMBGROUP_CODE}+"/"+$F{RANK}]]></textFieldExpression>
				</textField>
				<subreport>
					<reportElement uuid="6d8f2ae3-1c59-4312-9180-43b44b723297" positionType="Float" x="44" y="111" width="480" height="14"/>
					<subreportParameter name="adtm_date">
						<subreportParameterExpression><![CDATA[$F{BALANCE_DATE}]]></subreportParameterExpression>
					</subreportParameter>
					<subreportParameter name="as_memberno">
						<subreportParameterExpression><![CDATA[$F{MEMBER_NO}]]></subreportParameterExpression>
					</subreportParameter>
					<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					<subreportExpression><![CDATA["ir_mbshr_confirm_dep.jasper"]]></subreportExpression>
				</subreport>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="351">
				<staticText>
					<reportElement uuid="03c9469e-3d66-4de9-bf87-4c49f5c2ea85" x="334" y="13" width="188" height="20"/>
					<textElement textAlignment="Center">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<text><![CDATA[ขอแสดงความนับถือ]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="be5c42c2-9efd-41ac-9ed6-15f67806d390" x="334" y="52" width="188" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Bottom">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<text><![CDATA[(......................................................................)]]></text>
				</staticText>
				<line>
					<reportElement uuid="8dd7a773-c8ef-43dd-be46-ff3b19778cc1" x="0" y="78" width="555" height="1"/>
					<graphicElement>
						<pen lineStyle="Dotted"/>
					</graphicElement>
				</line>
				<staticText>
					<reportElement uuid="7c1ccc95-b652-4f4f-9b60-0ebb2b942e93" x="0" y="90" width="555" height="20"/>
					<textElement textAlignment="Center">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<text><![CDATA[หนังสือยืนยันยอดเงินรับฝาก]]></text>
				</staticText>
				<textField>
					<reportElement uuid="2219e47f-c8b2-4c8c-8a3c-8f5f19066828" x="424" y="90" width="131" height="20"/>
					<textElement>
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA["เลขที่ "+$F{MEMBGROUP_CODE}+"/"+$F{RANK}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="32c25854-3e7b-4396-9cb0-c8dddcae9faa" x="0" y="128" width="291" height="20"/>
					<textElement verticalAlignment="Bottom">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<text><![CDATA[เรียน ................................................................................................ ผู้สอบบัญชี]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="2dc35999-318d-4d03-9e49-95088efbfd94" x="0" y="148" width="291" height="17"/>
					<textElement verticalAlignment="Middle">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<text><![CDATA[.............................................................................................................................]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="52e46d11-ad13-47d4-9cfe-c9e6a4880c33" x="0" y="165" width="291" height="17"/>
					<textElement verticalAlignment="Bottom">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<text><![CDATA[.............................................................................................................................]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="174098dc-a53d-41c1-94c5-40cda2e5e270" x="0" y="182" width="291" height="17"/>
					<textElement verticalAlignment="Bottom">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<text><![CDATA[.............................................................................................................................]]></text>
				</staticText>
				<staticText>
					<reportElement uuid="f304f2be-6386-4e29-a2d7-f2d9b6f0151b" x="44" y="199" width="511" height="20"/>
					<textElement verticalAlignment="Bottom">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<text><![CDATA[ข้าพเจ้าขอยืนยันจำนวนเงินรับฝาก ระหว่างข้าพเจ้ากับสหกรณ์ออมทรัพย์มหาวิทยาลัยแม่โจ้ จำกัด     ณ วันที่ ]]></text>
				</staticText>
				<textField>
					<reportElement uuid="f49c1d7b-5585-4993-a213-1cf99194b3ea" x="13" y="219" width="511" height="20"/>
					<textElement>
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA[new SimpleDateFormat("dd/MM/yyyy",new Locale("th","TH")).format($P{adtm_date})+"    ดังนี้"]]></textFieldExpression>
				</textField>
				<subreport>
					<reportElement uuid="05ea3ebb-74eb-44f4-9263-018799112c27" positionType="Float" x="44" y="275" width="480" height="11"/>
					<subreportParameter name="adtm_date">
						<subreportParameterExpression><![CDATA[$F{BALANCE_DATE}]]></subreportParameterExpression>
					</subreportParameter>
					<subreportParameter name="as_memberno">
						<subreportParameterExpression><![CDATA[$F{MEMBER_NO}]]></subreportParameterExpression>
					</subreportParameter>
					<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
					<subreportExpression><![CDATA["ir_mbshr_confirm_dep.jasper"]]></subreportExpression>
				</subreport>
				<textField>
					<reportElement uuid="e8988512-fd11-4600-b54a-2dbecc8d0eb1" positionType="Float" x="334" y="302" width="188" height="20"/>
					<textElement textAlignment="Center">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA["("+$F{PRENAME_DESC}+$F{MEMB_NAME}+" "+$F{MEMB_SURNAME}+")"]]></textFieldExpression>
				</textField>
				<textField>
					<reportElement uuid="c104b6fd-dfa3-47d0-8e1e-b5ef0e6ed7f2" positionType="Float" x="334" y="322" width="188" height="20"/>
					<textElement textAlignment="Center">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA["เลขทะเบียนที่ "+$F{MEMBER_NO}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement uuid="e8dfe586-92ce-4b8d-9368-295ad569f047" x="69" y="239" width="486" height="20"/>
					<textElement verticalAlignment="Bottom">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<text><![CDATA[(   )   ถูกต้อง	            (   )   ไม่ถูกต้อง   ดังนี้]]></text>
				</staticText>
				<textField isBlankWhenNull="true">
					<reportElement uuid="14a91196-f269-4bc3-a2d6-a0c9453e3f5c" x="352" y="52" width="152" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA[$P{as_manager}]]></textFieldExpression>
				</textField>
				<textField isBlankWhenNull="true">
					<reportElement uuid="e773021f-6255-403e-a950-894be8f23876" x="26" y="128" width="211" height="20"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="Angsana New" size="14"/>
					</textElement>
					<textFieldExpression><![CDATA[$P{as_auditor}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<pageHeader>
		<band height="20">
			<subreport>
				<reportElement uuid="b5b645bc-bd99-4cee-b97f-f996605780f6" x="0" y="0" width="555" height="20"/>
				<subreportParameter name="as_coopid">
					<subreportParameterExpression><![CDATA[$P{as_coopid}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="as_reportid">
					<subreportParameterExpression><![CDATA[$P{as_reportid}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="as_entryid">
					<subreportParameterExpression><![CDATA[$P{as_entryid}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="as_reportdetail"/>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA["report_header\\ir_header_portrait.jasper"]]></subreportExpression>
			</subreport>
		</band>
	</pageHeader>
</jasperReport>
